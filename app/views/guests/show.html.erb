<!-- app/views/guests/show.html.erb -->
<div class="mb-8">
  <h1 class="text-4xl font-bold uppercase mb-4 border-b-4 border-black pb-2"><%= @guest.name %></h1>
  <div class="flex gap-4 items-center">
    <% if @guest.is_household_member? %>
      <span class="bg-black text-white px-2 py-1 text-xs uppercase">HOUSEHOLD MEMBER</span>
    <% end %>
    <span class="uppercase">MEALS ATTENDED: <%= @meals.count %></span>
    <%= link_to "EDIT", edit_guest_path(@guest), class: "underline" %>
    <%= link_to "FULL REPORT", by_guest_reports_path(guest_id: @guest.id), class: "underline" %>
  </div>
  <% if @guest.comments.present? %>
    <p class="mt-4 border-2 border-gray-400 p-4"><%= @guest.comments %></p>
  <% end %>
</div>

<div>
  <h2 class="text-2xl font-bold uppercase mb-4 border-b-2 border-black pb-2">Recent Meals</h2>
  <div class="space-y-4">
    <% @meals.each do |meal| %>
      <div class="border-2 border-black p-4">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="font-bold uppercase">
              <%= link_to meal.display_name, meal_path(meal), class: "hover:underline" %>
            </h3>
            <p class="text-sm uppercase mt-1">
              WITH: <%= meal.guests.where.not(id: @guest.id).pluck(:name).join(", ") %>
            </p>
            <div class="mt-2">
              <% meal.courses.each do |course| %>
                <p class="text-sm">
                  <span class="font-bold"><%= course.name %>:</span>
                  <%= course.recipes.pluck(:title).join(", ") %>
                </p>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>